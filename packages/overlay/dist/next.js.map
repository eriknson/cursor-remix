{"version":3,"sources":["../src/next.ts"],"sourcesContent":["import { createNextHandler, type ShipflowOverlayServerOptions } from \"./server/createNextHandler\";\n\ntype NextConfig = Record<string, unknown>;\n\nexport type ShipflowOverlayNextOptions = {\n  enableInProduction?: boolean;\n  reactGrabUrl?: string;\n  logClipboardEndpoint?: string;\n};\n\nexport function withShipflowOverlay<T extends NextConfig = NextConfig>(\n  config: T = {} as T,\n  options: ShipflowOverlayNextOptions = {},\n): T & NextConfig {\n  const enabled =\n    options.enableInProduction || process.env.NODE_ENV === \"development\";\n\n  const env: Record<string, string | undefined> = {\n    ...(config.env as Record<string, string | undefined> | undefined),\n    SHIPFLOW_OVERLAY_ENABLED: enabled ? \"true\" : \"false\",\n  };\n\n  if (options.reactGrabUrl) {\n    env.SHIPFLOW_OVERLAY_REACT_GRAB_URL = options.reactGrabUrl;\n  }\n\n  if (options.logClipboardEndpoint) {\n    env.SHIPFLOW_OVERLAY_LOG_ENDPOINT = options.logClipboardEndpoint;\n  }\n\n  const existingTranspile = Array.isArray(config.transpilePackages)\n    ? config.transpilePackages\n    : [];\n  const transpilePackages = Array.from(\n    new Set([...existingTranspile, \"@shipflow/overlay\"]),\n  );\n\n  return {\n    ...config,\n    env,\n    transpilePackages,\n  };\n}\n\nexport { createNextHandler, type ShipflowOverlayServerOptions };\n"],"mappings":";;;;;AAUO,SAAS,oBACd,SAAY,CAAC,GACb,UAAsC,CAAC,GACvB;AAChB,QAAM,UACJ,QAAQ,sBAAsB,QAAQ,IAAI,aAAa;AAEzD,QAAM,MAA0C;AAAA,IAC9C,GAAI,OAAO;AAAA,IACX,0BAA0B,UAAU,SAAS;AAAA,EAC/C;AAEA,MAAI,QAAQ,cAAc;AACxB,QAAI,kCAAkC,QAAQ;AAAA,EAChD;AAEA,MAAI,QAAQ,sBAAsB;AAChC,QAAI,gCAAgC,QAAQ;AAAA,EAC9C;AAEA,QAAM,oBAAoB,MAAM,QAAQ,OAAO,iBAAiB,IAC5D,OAAO,oBACP,CAAC;AACL,QAAM,oBAAoB,MAAM;AAAA,IAC9B,oBAAI,IAAI,CAAC,GAAG,mBAAmB,mBAAmB,CAAC;AAAA,EACrD;AAEA,SAAO;AAAA,IACL,GAAG;AAAA,IACH;AAAA,IACA;AAAA,EACF;AACF;","names":[]}